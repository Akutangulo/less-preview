window.LessCompiler=function(){function e(e,t){if(!e)return;this.elements=e;this.editor=CodeMirror.fromTextArea(e.lessInput[0],{theme:"lesser-dark",lineNumbers:!0,matchBrackets:!0,tabSize:2});t==null&&(t={lessCDN:"//raw.github.com/cloudhead/less.js/master/dist/less-{version}.js"});this.options=t}e.name="LessCompiler";return e}();LessCompiler.prototype.setupEvents=function(){var e="previousLessCode",t="change",n=this,r=this.elements,i=this.editor;this[e]=i.getValue();r.lessVersion.on(t,function(){n.loadLess()});i.on(t,function(){var t=n.editor.getValue();if(n[e]===t)return;n[e]=t;n.compileLess()})};LessCompiler.prototype.loadLess=function(){var e,t,n="loadingGif",r="options",i=this,s=this.elements;s[n].fadeIn();this.editor[r].readOnly=!0;e=s.lessVersion.val();t=this[r].lessCDN.replace("{version}",e);window.less=undefined;$.ajax({dataType:"script",cache:!0,url:t}).then(function(){i.parser=new less.Parser({});i.editor[r].readOnly=!1;i.compileLess();s[n].fadeOut()})};LessCompiler.prototype.compileLess=function(){var e,t,n,r="color",i=this.elements,s=this.editor.getValue();try{e=this.parseLess(s);t=hljs.highlight("css",e).value;i.cssCode.css(r,"").html(t)}catch(o){n=o.type+" error: "+o.message+"\n"+(o.extract&&o.extract.join(""));i.cssCode.css(r,"red").text(n)}};LessCompiler.prototype.parseLess=function(e){var t="";this.parser.parse(e,function(e,n){if(e)throw e;t=n.toCSS()});return t};jQuery(function(e){var t={lessVersion:e("#lessVersion"),loadingGif:e("#loadingGif"),lessInput:e("#lessInput"),cssCode:e("#cssOutput")};window.compiler=new LessCompiler(t);compiler.setupEvents();compiler.loadLess()});