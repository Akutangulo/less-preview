window.LessCompiler=function(){function e(e,t){if(!e)return;this.elements=e;this.editor=CodeMirror.fromTextArea(e.lessInput[0],{theme:"lesser-dark",lineNumbers:!0,matchBrackets:!0,tabSize:2});t==null&&(t={lessCDN:"//raw.github.com/cloudhead/less.js/master/dist/less-{version}.js"});this.options=t}e.name="LessCompiler";return e}();LessCompiler.prototype.setupEvents=function(){var e="previousLessCode",t="change",n=this,r=this.elements,i=this.editor;this[e]=i.getValue();r.lessVersion.on(t,function(){n.loadLess()});i.on(t,function(){var t=n.editor.getValue();if(n[e]===t)return;n[e]=t;n.compileLess()})};LessCompiler.prototype.loadLess=function(){var e,t,n="options",r=this,i=this.elements;this.editor[n].readOnly=!0;e=i.lessVersion.val();t=this[n].lessCDN.replace("{version}",e);window.less=undefined;$.ajax({dataType:"script",cache:!0,url:t}).then(function(){r.parser=new less.Parser({});r.editor[n].readOnly=!1;r.compileLess()})};LessCompiler.prototype.compileLess=function(){var e,t,n="color",r=this.elements,i=this.editor.getValue();try{e=this.parseLess(i);r.cssCode.css(n,"").text(e)}catch(s){t=s.type+" error: "+s.message+"\n"+(s.extract&&s.extract.join(""));r.cssCode.css(n,"red").text(t)}};LessCompiler.prototype.parseLess=function(e){var t="";this.parser.parse(e,function(e,n){if(e)throw e;t=n.toCSS()});return t};jQuery(function(e){var t={lessVersion:e("#lessVersion"),lessInput:e("#lessInput"),cssCode:e("#cssOutput")};window.compiler=new LessCompiler(t);compiler.setupEvents();compiler.loadLess()});