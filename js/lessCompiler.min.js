var Stor=function(){function n(t,n){this.key=t!=e?t:void 0;this.exp=n!=e?n:e;this.amp=amplify.store}var e=null,t="prototype";n[t].get=function(t){t==e&&(t=this.key);return this.amp(t)};n[t].set=function(t,n,r){n==e&&(n=this.key);r==e&&(r=this.exp);return this.amp(n,t,r)};n[t].remove=function(t){t==e&&(t=this.key);return this.amp(t,e)};n[t].empty=function(){var t=this,n=t.amp();return $.each(n,function(n,r){return t.amp(r,e)})};return n}(),LessCompiler=function(){function g(s,o){var u;if(!s)return;this[e]=s;this[t]=CodeMirror.fromTextArea(s.lessInput[0],{theme:"lesser-dark",lineNumbers:n,matchBrackets:n,tabSize:2});u={lessCDN:"//raw.github.com/cloudhead/less.js/master/dist/less-{version}.js",cdnFallback:"js/less/less-{version}.js",useFallback:!1,saveLess:n};this[r]=$.extend(u,o);this[i]=new Stor("lessCode")}var e="elements",t="editor",n=!0,r="options",i="storage",s="prototype",o="previousLessCode",u="getValue",a="lessVersion",f="change",l="loadLess",c="compileLess",h="useFallback",p="loadingGif",d="loadComplete",v="tryCount",m="color";g[s].setupEvents=function(){var n=this,r=this[e],s=this[t],h=this[i].get();if(h){s.setValue(h);this[o]=h}else this[o]=s[u]();r[a].on(f,function(){n[l]()});s.on(f,function(){var e=n[t][u]();if(n[o]===e)return;n[o]=e;n[c]()})};g[s][l]=function(){var i,s,o,u=this,f=this[e],c=this[r],m=c[h]?c.cdnFallback:c.lessCDN;f[p].fadeIn();this[t][r].readOnly=n;i=f[a].val();s=m.replace("{version}",i);window.less=undefined;o=$.ajax({dataType:"script",cache:n,url:s});o.then(function(){if(window.less)u[d].call(u);else{u[v]=u[v]?u[v]++:1;u[r][h]=n;u[v]<=3&&u[l]()}})};g[s][d]=function(){this.parser=new less.Parser({});this[t][r].readOnly=!1;this[c]();this[e][p].fadeOut()};g[s][c]=function(){var n,s,o,a=this[e],f=this[t][u]();this[r].saveLess&&this[i].set(f);try{n=this.parseLess(f);s=hljs.highlight("css",n).value;a.cssCode.css(m,"").html(s)}catch(l){o=l.type+" error: "+l.message+"\n"+(l.extract&&l.extract.join(""));a.cssCode.css(m,"red").text(o)}};g[s].parseLess=function(e){var t="";this.parser.parse(e,function(e,n){if(e)throw e;t=n.toCSS()});return t};return g}();jQuery(function(e){var t={lessVersion:e("#lessVersion"),loadingGif:e("#loadingGif"),lessInput:e("#lessInput"),cssCode:e("#cssOutput")},n=window.comp=new LessCompiler(t);n.setupEvents();n.loadLess()});