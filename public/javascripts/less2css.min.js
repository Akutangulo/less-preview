(function(){var Stor,t;Stor=function(){function Stor(t,e){this.key=null!=t?t:void 0,this.exp=null!=e?e:null,this.amp=amplify.store}return Stor.prototype.get=function(t){return null==t&&(t=this.key),this.amp(t)},Stor.prototype.set=function(t,e,s){return null==e&&(e=this.key),null==s&&(s=this.exp),this.amp(e,t,s)},Stor.prototype.remove=function(t){return null==t&&(t=this.key),this.amp(t,null)},Stor.prototype.empty=function(){var t,e;return t=this,e=t.amp(),$.each(e,function(e,s){t.amp(s,null)})},Stor}(),jQuery(function($){var OptionsDrawer,t;return OptionsDrawer=function(){function OptionsDrawer(){this.els={lessOptions:$("#lessOptions"),optsDrawer:$("#optionsDrawer"),optsWrap:$("#optionsDrawerWrap"),optsBtn:$("#optionsButton"),optsLnk:$("#optionsLink"),nav:$("#nav")},this.fx={duration:300},this.text={optsOpen:"Close",optsDefault:"Options"},this.isOpen=!1,this.closeDrawer(!0),this.setupEvents()}return OptionsDrawer.prototype.setupEvents=function(){var t,e;e=this,t=e.els,t.optsBtn.on("click",function(t){t.preventDefault(),e.isOpen?e.closeDrawer.call(e):e.openDrawer.call(e)}),t.optsLnk.on("click",function(e){e.preventDefault(),t.optsBtn.trigger("click")})},OptionsDrawer.prototype.openDrawer=function(){var t,e;this.els.lessOptions.addClass("open"),e={top:this.els.nav.height(),opacity:1},t={duration:this.fx.duration},this.detach(),this.animateDrawer("open",e,t)},OptionsDrawer.prototype.closeDrawer=function(t){var e,s,n;e=this.els,e.lessOptions.removeClass("open"),n={top:-this.getDrawerTop(),opacity:0},s={duration:t?0:this.fx.duration},s.complete=t?function(){return e.optsDrawer.fadeIn()}:void 0,this.animateDrawer("close",n,s)},OptionsDrawer.prototype.animateDrawer=function(t,e,s){var n,o,r,i;i=this,r=this.els.optsDrawer,o=new $.Deferred,n=s.complete||function(){},s.complete=function(){return o.resolve(),n.apply(i,arguments)},r.animate(e,s),o.done(function(){return"close"===t?i.onClose.call(i):i.onOpen.call(i)})},OptionsDrawer.prototype.onOpen=function(){this.isOpen=!0},OptionsDrawer.prototype.onClose=function(){this.attach(),this.isOpen=!1},OptionsDrawer.prototype.getDrawerTop=function(){return this.els.optsDrawer.outerHeight()-this.els.nav.height()},OptionsDrawer.prototype.getBtnLeft=function(){var t;return t=this.els.optsBtn[0],t.parentElement.offsetLeft+t.parentElement.parentElement.offsetLeft},OptionsDrawer.prototype.attach=function(){this.els.optsBtn.insertAfter(this.els.optsLnk),this.els.optsBtn.removeClass("active")[0].style.cssText=""},OptionsDrawer.prototype.detach=function(){var t,e,s,n;t=this.els,s=t.optsBtn,n=s.width(),e=this.getBtnLeft(),t.optsBtn.css({left:e,width:n}).addClass("active"),this.els.optsBtn.appendTo(this.els.optsWrap)},OptionsDrawer}(),t=new OptionsDrawer}),t=angular.module("Less2Css",[]),t.run(["$rootScope",function(t){return t.$safeApply=function(e,s){e=e||t,s=s||function(){},e.$$phase?s():e.$apply(s)}}]),t.directive("lessEditor",[function(){return{restrict:"A",require:"ngModel",link:function(t,e,s,n){var o,r;return r=function(){return function(e){var s;s=e.getValue(),s!==n.$viewValue&&(n.$setViewValue(s),t.$apply())}},o=function(){var o,i;i=t[s.opts],o=CodeMirror.fromTextArea(e[0],i),o.on("change",r(i.onChange)),n.$render=function(){o.setValue(n.$viewValue)}},t.$on("optionsLoaded",o)}}}]),t.factory("LessCompiler",function(){var t;return t=function(){function t(){this.options={useFallback:!1,saveLess:!0,lessPath:"/javascripts/less/less-{version}.js",lessOptions:{dumpLineNumbers:!1,relativeUrls:!1,rootpath:!1,filename:"less2css.org.less"}},this.defaults=_.cloneDeep(this.options)}return t.prototype.updateOptions=function(t){var e,s,n;e=this.options.lessOptions;for(s in e)n=e[s],e[s]=t.hasOwnProperty(s)?t[s]:this.defaults.lessOptions[s]},t.prototype.setupEvents=function(){var t,e,s,n,o;return n=this,s=this.elements,e=this.editor,t=this.storage.get(),o=s.lessVersion.find("option"),t?(e.setValue(t),this.previousLessCode=t):this.previousLessCode=e.getValue(),this.drawer.on("change",function(t,e){var s,o,r;return s=$(t.target),o=s.attr("name"),"lessVersion"===o?(r=s.find("option").filter(":selected").is("[data-prerelease=true]")?!0:!1,n.loadLess(r)):(n.updateOptions(e),n.loadComplete.call(n)),console.log(e)}),e.on("change",function(){var t;t=n.editor.getValue(),n.previousLessCode!==t&&(n.previousLessCode=t,n.compileLess())}),this},t.prototype.loadLess=function(t){var e,s,n,o,r,i;return r=this,n=this.options,e=this.elements,e.loadingGif.fadeIn(),this.editor.options.readOnly=!0,i=e.lessVersion.val(),i=t?""+i+"-alpha":i,o=n.lessPath.replace("{version}",i),window.less=void 0,s=$.ajax({dataType:"script",cache:!0,url:o}),s.done(function(){r.loadComplete.call(r)}),this},t.prototype.loadComplete=function(){return this.parser=new less.Parser(this.options.lessOptions),this.editor.options.readOnly=!1,this.compileLess(),this.elements.loadingGif.fadeOut(),this},t.prototype.compileLess=function(){var t,e;e=this.editor.getValue(),this.options.saveLess&&this.storage.set(e);try{t=this.parseLess(e),this.updateCSS(t)}catch(s){this.updateError(s)}return this},t.prototype.updateCSS=function(t){var e;return e=hljs.highlight("css",t).value,this.elements.cssCode.css("color","").html(e),this},t.prototype.updateError=function(t){var e;return e=""+t.type+" error: "+t.message+"\n"+(t.extract&&t.extract.join&&t.extract.join("")),this.elements.cssCode.css("color","red").text(e),this},t.prototype.parseLess=function(t){var e;return e="",this.parser.parse(t,function(t,s){if(t)throw t;return e=s.toCSS()}),e},t}(),jQuery(function($){var e,s;return s={lessVersion:$("#lessVersion"),loadingGif:$("#loadingGif"),lessInput:$("#lessInput"),cssCode:$("#cssOutput")},e=window.comp=new t(s),e.setupEvents().loadLess()}),new t}),t.controller("Less2CssCtrl",["$scope","$http",function(t,e){var s,n,o;return o=new Stor("lessCode"),t.updateOptions=function(){return console.log(this),t.lessOptions.dumpLineNumbers=t.lineNumbersEnabled?t.dumpLineNumbers:!1,t.lessOptions.rootpath=t.rootPathEnabled?t.rootpath:!1},t.toggleLineNumbers=function(){t.lineNumbersEnabled=!t.lineNumbersEnabled,t.updateOptions()},t.toggleRootPath=function(){t.rootPathEnabled=!t.rootPathEnabled,t.updateOptions()},e.get("/less-options").success(function(e){n(e),s(e),t.$emit("optionsLoaded")}),t.cssOutput="a.cool { display: none; }",t.$watch("lessInput",function(){}),t.toggleTxt=function(e){return t[e]?"Enabled":"Disabled"},t.lessInput=document.getElementById("lessInput").value,n=function(e){var s,n;for(s in e)n=e[s],t[s]=n},s=function(e){t.lessOptions.lessVersion=function(){var t;return t=_.find(e.lessVersions,function(t){return"current"===t.type}),t.number}(),t.dumpLineNumbers=function(){var t;return t=_.find(e.lineNumberOptions,function(t){return!!t["default"]}),t.value}()}}])}).call(this);