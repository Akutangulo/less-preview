(function(){var Stor,t;Stor=function(){function Stor(t,e){this.key=null!=t?t:void 0,this.exp=null!=e?e:null,this.amp=amplify.store}return Stor.prototype.get=function(t){return null==t&&(t=this.key),this.amp(t)},Stor.prototype.set=function(t,e,n){return null==e&&(e=this.key),null==n&&(n=this.exp),this.amp(e,t,n)},Stor.prototype.remove=function(t){return null==t&&(t=this.key),this.amp(t,null)},Stor.prototype.empty=function(){var t,e;return t=this,e=t.amp(),$.each(e,function(e,n){t.amp(n,null)})},Stor}(),jQuery(function($){var OptionsDrawer,t;return OptionsDrawer=function(){function OptionsDrawer(){this.els={lessOptions:$("#lessOptions"),optsDrawer:$("#optionsDrawer"),optsWrap:$("#optionsDrawerWrap"),optsBtn:$("#optionsButton"),optsLnk:$("#optionsLink"),nav:$("#nav")},this.fx={duration:300},this.text={optsOpen:"Close",optsDefault:"Options"},this.isOpen=!1,this.closeDrawer(!0),this.setupEvents()}return OptionsDrawer.prototype.setupEvents=function(){var t,e;e=this,t=e.els,t.optsBtn.on("click",function(t){t.preventDefault(),e.isOpen?e.closeDrawer.call(e):e.openDrawer.call(e)}),t.optsLnk.on("click",function(e){e.preventDefault(),t.optsBtn.trigger("click")})},OptionsDrawer.prototype.openDrawer=function(){var t,e;this.els.lessOptions.addClass("open"),e={top:this.els.nav.height(),opacity:1},t={duration:this.fx.duration},this.detach(),this.animateDrawer("open",e,t)},OptionsDrawer.prototype.closeDrawer=function(t){var e,n,s;e=this.els,e.lessOptions.removeClass("open"),s={top:-this.getDrawerTop(),opacity:0},n={duration:t?0:this.fx.duration},n.complete=t?function(){return e.optsDrawer.fadeIn()}:void 0,this.animateDrawer("close",s,n)},OptionsDrawer.prototype.animateDrawer=function(t,e,n){var s,o,r,i;i=this,r=this.els.optsDrawer,o=new $.Deferred,s=n.complete||function(){},n.complete=function(){return o.resolve(),s.apply(i,arguments)},r.animate(e,n),o.done(function(){return"close"===t?i.onClose.call(i):i.onOpen.call(i)})},OptionsDrawer.prototype.onOpen=function(){this.isOpen=!0},OptionsDrawer.prototype.onClose=function(){this.attach(),this.isOpen=!1},OptionsDrawer.prototype.getDrawerTop=function(){return this.els.optsDrawer.outerHeight()-this.els.nav.height()},OptionsDrawer.prototype.getBtnLeft=function(){var t;return t=this.els.optsBtn[0],t.parentElement.offsetLeft+t.parentElement.parentElement.offsetLeft},OptionsDrawer.prototype.attach=function(){this.els.optsBtn.insertAfter(this.els.optsLnk),this.els.optsBtn.removeClass("active")[0].style.cssText=""},OptionsDrawer.prototype.detach=function(){var t,e,n,s;t=this.els,n=t.optsBtn,s=n.width(),e=this.getBtnLeft(),t.optsBtn.css({left:e,width:s}).addClass("active"),this.els.optsBtn.appendTo(this.els.optsWrap)},OptionsDrawer}(),t=new OptionsDrawer}),t=angular.module("Less2Css",[]),t.run(["$rootScope",function(t){return t.$safeApply=function(e,n){e=e||t,n=n||function(){},e.$$phase?n():e.$apply(n)}}]),t.directive("lessEditor",[function(){return{restrict:"A",require:"ngModel",link:function(t,e,n,s){var o,r;return r=function(){return function(e){var n;n=e.getValue(),n!==s.$viewValue&&(s.$setViewValue(n),t.$apply())}},o=function(){var o,i;i=t[n.opts],o=CodeMirror.fromTextArea(e[0],i),o.on("change",r(i.onChange)),s.$render=function(){o.setValue(s.$viewValue)}},t.$on("optionsLoaded",o)}}}]),t.factory("LessCache",function(){return new Stor("lessCode")}),t.factory("LessCompiler",["$http","LessCache",function(t,e){var n;return n=function(){function t(){this.options={saveLess:!0,lessPath:"/javascripts/less/less-{version}.js"},this.defaults=_.cloneDeep(this.options),this.storage=e}return t.prototype.updateOptions=function(t){return this.lessOptions=t},t.prototype.loadLess=function(){var t,e,n,s,o;return n=this.options,e=this.lessOptions,o=e.lessVersion,o=o===e.preRelease?""+o+"-alpha":o,s=n.lessPath.replace("{version}",o),window.less=void 0,t=$.ajax({dataType:"script",cache:!0,url:s})},t.prototype.initLess=function(){return this.parser=new less.Parser(this.lessOptions)},t.prototype.compileLess=function(t){var e;try{return e=this.parseLess(t,this.lessOptions)}catch(n){return this.updateError(n)}},t.prototype.updateError=function(t){var e;return e=""+t.type+" error: "+t.message+"\n"+(t.extract&&t.extract.join&&t.extract.join(""))},t.prototype.parseLess=function(t){var e;return e="",this.parser.parse(t,function(t,n){if(t)throw t;return e=n.toCSS()}),e},t}(),new n}]),t.controller("Less2CssCtrl",["$scope","$http","LessCompiler",function(t,e,n){var s,o;return e.get("/less-options").success(function(e){var r;o(e),s(e),t.$emit("optionsLoaded"),t.updateOptions(),r=n.loadLess(),r.done(function(){var e;console.log("Done"),n.initLess(),e=n.compileLess(t.lessInput),t.cssOutput=e,t.$apply(),console.log(e)})}),t.cssOutput="a.cool { display: none; }",t.$watch("lessInput",function(){return t.cssOutput=n.compileLess(t.lessInput),t.$safeApply()}),t.updateOptions=function(){return t.lessOptions.dumpLineNumbers=t.lineNumbersEnabled?t.dumpLineNumbers:!1,t.lessOptions.rootpath=t.rootPathEnabled?t.rootpath:!1,n.updateOptions(t.lessOptions)},t.toggleLineNumbers=function(){t.lineNumbersEnabled=!t.lineNumbersEnabled,t.updateOptions()},t.toggleRootPath=function(){t.rootPathEnabled=!t.rootPathEnabled,t.updateOptions()},t.toggleTxt=function(e){return t[e]?"Enabled":"Disabled"},t.lessInput=document.getElementById("lessInput").value,o=function(e){var n,s;for(n in e)s=e[n],t[n]=s},s=function(e){_.each(e.lessVersions,function(e){return"current"===e.type&&(t.lessOptions.lessVersion=e.number),"pre"===e.type?t.lessOptions.preRelease=e.number:void 0}),t.dumpLineNumbers=function(){var t;return t=_.find(e.lineNumberOptions,function(t){return!!t["default"]}),t.value}()}}])}).call(this);